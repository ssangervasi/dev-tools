#!/usr/bin/env bash

TICKETS_HOME="${TICKETS_HOME:-$HOME/tickets}"

_new() {
	ticket_name="$1"

	pushd "$TICKETS_HOME" || return
	echo "$ticket_name" > ticket.hist

	mkdir "${ticket_name}"
	pushd ./"${ticket_name}" || return
	TICKET_HOME="$PWD"

	touch ./notes.md
	mkdir screenshots

	echo "$TICKET_HOME"
}

_latest() {
	cd "$TICKETS_HOME" || return
	cat ./ticket.hist
}

_dir() {
	echo "$TICKETS_HOME"/$(_latest)
}

_help() {
	cat <<-HELP_TEXT
		ticket
			new <ticket_or_feature_name>
	HELP_TEXT
}

cmd="$1"
shift

"_${cmd:-help}" "$@"
